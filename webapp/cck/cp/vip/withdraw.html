<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>会员中心</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/hpn-common.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" type="text/css" href="css/global.css">
    <script>
        <!--
//        window.onerror=function(){return true;}
        // -->
    </script>
    <script>
    <!--
    // 屏蔽JS错误
//    window.onerror = function(){return true;}
    // -->
    var nowHref = "../error/index.html";
</script>
<script src="../static/public/js/mobile-detect.min.js"></script><style>
        .eveb_nav_sub .on,.button_1, .button_1:link, .button_1:visited,.alert_col h5,.onlineService,.head,.layui-layer-popup .layui-layer-title,.xzqd,.game_name .box2_stage p span i.acti,.Betting,.Single,.list_ject ul li .Result p a.acti,.list_ject ul li .Result p a.acti:hover,.top{background:#fa6200!important}
        .eveb_nav_sub .on a,.bankInfo .name,.help_l_menu .title p .sum,.help_r_main .light,.game_name .box2_stage p span i,.game_name .box1_name  p i,.Account p a.red{color:#fa6200!important}
        .eveb_nav_sub .on,.game_name .box2_stage p span{border:1px solid #fa6200!important;}
        .eveb_nav_sub .on,.game_name .box2_stage p span i.acti{color:#fff!important;}
        .eveb_nav_sub .on a{border-top:1px #fa6200 solid!important;}
        .eveb_nav_sub ul{border-bottom:1px #fa6200 solid!important;}
        .alert_col div::-webkit-scrollbar-thumb {background-color: #fa6200!important;}
        .head div h5,.Betting .tabs ul li,.top .nav h1{background:#f87c2d!important}
        .jf_box .url a,.eveb_form label.error,.eveb_transfer_box .center_wallet .money,.eveb_transfer_box .wallet_list li p{color:#f87c2d!important}
        .Betting .tabs ul li.acti{background:#fff!important}
        .button_1, .button_1:link, .button_1:visited{border:1px solid #f87c2d!important;}
    </style>

    <link type="text/css" rel="stylesheet" href="../static/public/layer/skin/default/laydate.css">
    <link rel="stylesheet" href="../static/public/layer/skin/default/layer.css" id="layuicss-skinlayercss">
    <style>
        .eveb_content{ display: none;}
    </style>
</head>
<body>
<div class="help_r_main">
    <div class="eveb_content">
        <div class="eveb_transfer_box mb20 clearfix" style="overflow: visible;">
            <div class="center_wallet fl rel">
                <span>账户总余额</span>
                <p class="money"><strong id="wallet" class="money">00</strong>元</p>
                <div class="abs Res" onclick="refreshMoney()"><i class="icon resIcon"></i></div>
            </div>
            <ul class="wallet_list wallet_list2 fl">
                <li><span>可提款总额</span>
                    <p id="wallet_1" class="money">00</p></li>
            </ul>
        </div>
        <div class="eveb_content">
            <div class="mb10 color-888">提现到银行卡：</div>
            <form name="withdrawForm" novalidate="novalidate" onsubmit="return false;" class="czForm">
                <ul class="eveb_form">
                    <li>
                        <span>提现方式:</span>
                        <input type="text" id="cashType" value="银行" readonly="">
                    </li>
                    <li>
                        <span>所属银行：</span>
                        <div class="eveb_form_box eveb_bank_list yhzz">
                        </div>

                    </li>



                    <li>
                        <span>开户行城市：</span>
                        <select name="province" id="province">
                            <option value="" data-province="0">请选择…</option>
                        </select>
                        <select name="city" id="city">
                            <option value="" data-city="0">请选择…</option>
                        </select>
                        <select name="county" id="county">
                            <option value="" data-county="0">请选择…</option>
                        </select>
                    </li>
                    <li>
                        <span>银行帐号：</span>
                        <input class="suminp" name="bankAccount" type="text" id="bankAccount">
                        <label for="bankAccount" class="error">* 请输入银行帐号</label>
                    </li>
                    <li>
                        <span>账号姓名：</span>
                        <input type="text" name="userName" id="userName" class="suminp" readonly value="">
                        <label for="userName" class="error"></label>
                    </li>
                    <li>
                        <span>提款密码：</span>
                        <input type="password" name="userName" id="cashPassword" class="suminp" value="">
                        <label for="cashPassword" class="error">* 请输入提款密码</label>
                    </li>
                    <li>
                        <span>提款金额(元)：</span>
                        <input type="text" size="5" name="money" id="money" value="" class="suminp">
                        <label for="money" class="error">* 请输入提款金额,单笔最少100</label>
                    </li>
                </ul>
                <div class="eveb_form_submit">
                    <input type="submit" id="btnSubmit" value="提交" class="button_medium button_1">
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript" src="../static/public/js/jquery.min.js"></script>
<script type="text/javascript" src="../static/public/js/jquery.validate.min.js"></script>
<script type="text/javascript" src="../static/public/js/laydate.js"></script>
<script type="text/javascript" src="../static/public/js/validate.js"></script>
<script type="text/javascript" src="../static/public/js/global.js"></script>
<script type="text/javascript" src="../static/public/js/jquery.form.min.js"></script>
<script type="text/javascript" src="../static/public/js/jquery.md5.js"></script>
<script type="text/javascript" src="../static/public/layer/layer.js"></script>
<script type="text/javascript" src="../static/public/js/jquery.nicescroll.js"></script>
<script type="text/javascript" src="../static/public/js/clipboard.min.js"></script>
<script src="../static/public/js/dateformat.js"></script>
<script src="../static/public/js/template.js"></script>
<script src="../static/public/js/jquery.cookie.js"></script><!--自定义封装函数-->

<script src="../static/public/js/rollups/tripledes.js"></script>
<script src="../static/public/js/components/mode-ecb.js"></script>
<script src="../static/public/js/move.js"></script>
<script src="../static/public/js/base.js"></script>
<script>
    $(function() {
        var userType = $.cookie('type');
        if(userType != null && userType == '01') {
            var objImg = document.createElement('img');
            objImg.style.cssText= 'margin:auto;margin-top:15%;display:block;';
            objImg.src = "images/noaccess.png";
            $(".eveb_content").html(objImg);
            $('.eveb_content').show();
        }else {
            $('.eveb_content').show();
            //提现银行
            ajaxRequest({
                url: CONFIG.BASEURL + 'cash_bankList',
                success: function (json) {
                    var data = json.data.items[0].subitems;
                    var str = '';
                    $.each(data, function (index, value) {
                        var icon = '';
                        if (value == '中国工商银行') {
                            icon = 'icbc';
                        } else if (value == '中国建设银行') {
                            icon = 'ccb';
                        } else if (value == '中国银行') {
                            icon = 'chinabank';
                        } else if (value == '中国农业银行') {
                            icon = 'abchina';
                        } else if (value == '中国交通银行') {
                            icon = 'comm';
                        } else if (value == '中国光大银行') {
                            icon = 'cebbank';
                        } else if (value == '中国民生银行') {
                            icon = 'zgms';
                        } else if (value == '招商银行') {
                            icon = 'cmb';
                        } else if (value == '平安银行') {
                            icon = 'pingan';
                        } else if (value == '浦发银行') {
                            icon = 'spdb';
                        } else if (value == '上海银行') {
                            icon = 'bankofshanghai';
                        } else if (value == '中国邮政储蓄银行') {
                            icon = 'psbc';
                        } else if (value == '广发银行') {
                            icon = 'cgbchina';
                        } else if (value == '中信银行') {
                            icon = 'ecitic';
                        } else if (value == '华夏银行') {
                            icon = 'hxb';
                        } else if (value == '浦发银行') {
                            icon = 'spdb';
                        } else if (value == '兴业银行') {
                            icon = 'cib';
                        }
                        ;
                        str += '<label><input type="radio" name="userBankName" id="userBankName" value="' + value + '"><em class="banklogo bank-' + icon + '"></em></label>';
                    });
                    $('.yhzz').append(str);
                }
            });

            //提现省市区三级联动
            ajaxRequest({
                url: CONFIG.BASEURL + 'baseData_list3',
                beforeSend: function () {
                    parent.parent.showLoading();
                },
                success: function (json) {
                    var data = json.data.items;
                    var province = '';
                    parent.parent.hideLoading();
                    $.each(data, function (index, value) {
                        var citys = [];
                        $.each(value.list, function (i, v) {
                            citys.push(v.list);
                        });
                        province += '<option value="' + value.cid + '" data-province="' + value.cid + '">' + value.title + '</option>';
                    });
                    $('#province').append(province);
                    $("#province").bind('change', function () {
                        $('#city').html('<option value="" data-city="0">请选择…</option>');
                        $('#county').html('<option value="" data-city="0">请选择…</option>');
                        var val = $(this).val();
                        $.each(data, function (index, value) {
                            if (value.cid == val) {
                                var _city = '';
                                $.each(value.list, function (index, value) {
                                    _city += '<option value="' + value.cid + '" data-city="' + value.cid + '">' + value.title + '</option>';
                                });
                                $("#city").append(_city);
                            }
                        });
                    });
                    $("#city").bind('change', function () {
                        $('#county').html('<option value="" data-city="0">请选择…</option>');
                        var val = $(this).val();
                        $.each(data, function (index, value) {
                            $.each(value.list, function (index, value) {
                                if (value.cid == val) {
                                    var _county = '';
                                    $.each(value.list, function (index, value) {
                                        _county += '<option value="' + value.cid + '" data-city="' + value.cid + '">' + value.title + '</option>';
                                    });
                                    $("#county").append(_county);
                                }
                            });
                        });
                    });
                    $("#county").bind('change', function () {
                        window.getCid = $(this).val(); //获得开户行所在区id;
                    });
                },
                error: function (json) {
                    parent.parent.hideLoading();
                }
            });
        };

    });
</script>
<script>
    $(function () {
        refreshMoney();
        $(".errhide").addClass('hide');
        $("#userName").val($.cookie('userName'));
        $("#money").keyup(function () {
            var obj = this;
            obj.value = obj.value.replace(/[^\d.]/g, "");
            obj.value = obj.value.replace(/^\./g, "");
            obj.value = obj.value.replace(/^0/g, "");
            obj.value = obj.value.replace(/\.{2,}/g, ".");
            //确保只有一次小数点出现
            obj.value = obj.value.replace(".", "#").replace(/\./g, "").replace("#", ".");
            //确保小数点后是两位数字
            if (obj.value.indexOf(".") > 0 && obj.value.indexOf(".") + 4 <= obj.value.length) {
                obj.value = obj.value.substr(0, obj.value.indexOf(".") + 3);
            }
            $("#money").val(obj.value);

            //提示非法金额输入
            var maxMoney=$(".wallet_list .money").text();
            var inmoney=$("#money").val();
            if(parseInt(inmoney) > parseInt(maxMoney)){
//                $(".errhide").removeClass('hide');
                layer.msg("* 最大提款金额" + maxMoney);
                $("#money").val(' ');
            }

        });

        $("#btnSubmit").click(function () {
            var bankName=$.trim($("#userBankName:checked").val());
            var cashMoney=$.trim($("#money").val());
            var accountNo=$.trim($("#bankAccount").val());
            var userName=$.trim($("#userName").val());
            var cashPassword=$.trim($("#cashPassword").val());
            if(window.getCid){
                var cid=window.getCid;
            } else {
                var cid='';
            };
            var type=$("#cashType").val();
            if(!bankName || bankName=='请选择'){
                layer.msg('请选择银行');
                return false;
            }
            if(!cid){
                layer.msg('请选择城市');
                return false;
            }
            if(!accountNo){
                layer.msg('请填写银行账号');
                return false;
            }
            if(!userName){
                layer.msg('请填写账户姓名');
                return false;
            }
            if(!cashPassword){
                layer.msg('请填写提款密码');
                return false;
            }
            if(!cashMoney){
                layer.msg('请填写提款金额');
                return false;
            }else{
                if(parseFloat(cashMoney)>parseFloat($.cookie('money'))){
                    layer.msg('您的余额不足');
                    $("#money").val(' ');
                    return false;
                }else if(parseFloat(cashMoney)<100){
                    layer.msg('单笔最少100');
                    $("#money").val(' ');
                    return false;
                }

            }
            var map = {};
            map['u']=$.cookie('u');
            map['bankName']=bankName;
            map['cashMoney']=cashMoney;
            map['accountNo']=accountNo;
            map['userName']=userName;
            map['cashPassword']=$.md5(cashPassword).toUpperCase();
            map['cid']=cid;
            map['type']=type;
            var mw=baseObj.mw(map);
            ajaxRequest({
                type: "POST",
                url:CONFIG.BASEURL +'cash_submit',
                dataType:'json',
                data:{
                    mw:mw
                },
                success: function(ret){
                    var code=ret.code;
                    var msg=ret.msg;
                    if(code=='200'){
                        layer.msg('提现成功！');
                        getUserSession();
                        setTimeout(function () {
                            parent.$('.money').html($.cookie('money'));
                            window.location.reload();
                        },2000);
                    }else{
                        layer.msg(msg);
                    }
                    return false;
                },
                error: function (ret) {
                    console.log(ret);
                }
            });
        });

    });
    //获得用户金额
    function getUserSession() {
        var mw = baseObj.mw({
            u :$.cookie("u")
        });
        ajaxRequest({
            url: CONFIG.BASEURL+'baseData_money',
            data: {
                mw :mw
            },
            success: function (json) {
                if (json.code == 200) {
                    $.cookie('money',json.data.money,{path: "/" });
                } else {
                }
            }
        });
    }
    function refreshMoney() {
        var mw = baseObj.mw({
            u :$.cookie("u")
        });
        ajaxRequest({
            url: CONFIG.BASEURL+'baseData_money',
            data: {
                mw :mw
            },
            beforeSend: function () {
                $("#wallet_1").html('刷新中');
                $("#wallet").html('刷新中');
            },
            success: function (json) {
                if (json.code == 200) {
                    $.cookie('money',json.data.money,{path: "/" });
                    $("#wallet").html($.cookie('money'));
                    if(parseInt($.cookie('money')) > 100) {
                        $("#wallet_1").html($.cookie('money') + '元');
                    } else {
                        $('.wallet_list li span').html(' ');
                        $("#wallet_1").html('提现余额不足');
                    }
                }
            }
        });
    }
</script>

</body>
</html>