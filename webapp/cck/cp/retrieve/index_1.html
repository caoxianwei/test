<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    
    <!--页面CSS-->
    <!--CSS3动画-->
    <!--页面CSS-->
    <!--页面CSS-->
    
    <!--页面CSS-->
    <!--页面CSS-->
    <!--页面CSS-->
    <script src="../static/public/js/fancyzoom.js" language="JavaScript" type="text/javascript"></script>
    <script src="../static/public/js/fancyzoomhtml.js" language="JavaScript" type="text/javascript"></script>
    <script>
    <!--
    // 屏蔽JS错误
//    window.onerror = function(){return true;}
    // -->
    var nowHref = "../error/index.html";
</script>

<script src="../static/public/js/mobile-detect.min.js"></script>
<link media="all" href="index_1.css" type="text/css" rel="stylesheet">
</head>
<body>
<script>if (window.top === window.self) {window.location.href = "#";}</script><div class="type_top" style="z-index: 100;">
    <div class="wid1">
        <div class="left fl">
            <div class="left_div">你好，欢迎来到彩彩客彩票网!
                <a href="../login/index.html" class="log">请登录</a>
                        <span>
                            <a href="../register/index.html" class="a1 blink" style="color: rgb(15, 63, 148);">免费注册</a>
                        </span>
                    </div>
        </div>
        <div class="right fr">
            <ul>
                <li class="li0"><a href="../index.html">首页</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="img"><a href="../"><img src="../images/logo.png" alt=""></a></div>
<img src="../images/bj.jpg" class="back" alt="" style="height: 913px;" width="100%">
<div class="regedit">

    <div class="reg_col">
        <div class="reg_list">
            <ul>
                <li class="sli">
                    <h5>1</h5>
                    <p>找回密码</p>
                </li>
            </ul>
        </div>
        <div class="reg">
            <div class="reg_le">
                <form onsubmit="retrievePwd();return false;" action="../retrieve/index.html">
                    <div>
                        <h4><span><img src="../images/r1.png"></span></h4>
                        <p><input id="retrieveAccount" placeholder="请输入您的手机号" value="" type="text"></p>
                    </div>
                    <div>
                        <h4><span><img src="../images/r2.png"></span></h4>
                        <p><input id="retrievePassword" placeholder="请输入密码" type="password"></p>
                    </div>
                    <div>
                        <h4><span><img src="../images/r3.png"></span></h4>
                        <p>
                            <input id="retrieveYzm" class="short" style="width:115px;"  placeholder="请输入验证码" value="" type="text">
                            <input id="retrieveGetYzm" style="cursor: pointer; width: 100px;background: rgb(239, 107, 0);height: 30px;margin-top: -10px;color: #fff;" onclick="refreshYzm()" type="button" value="获取验证码">
                        </p>
                    </div>
                    <div class="no">
                        <h3><input value="立即提交" type="submit"></h3>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="copy">
    <p style="font-family: arial;">
        <script>
        var date = new Date;
        var year=date.getFullYear();
        document.write(year);
    </script>©彩彩客彩票网</p>&nbsp;&nbsp;
</div>

<script type="text/html" id="template_khxy">
</script>

<script type="text/javascript" src="../static/public/js/jquery.min.js"></script><!--jQuery库-->
<script type="text/javascript" src="../static/public/js/scrollanim.min.js"></script> <!--"动画库"-->
<script src="../static/public/js/type.js"></script><!--自定义封装函数-->
<script src="../static/public/js/global.js"></script><!--自定义封装函数-->
<script src="../static/public/js/jquery.cookie.js"></script><!--自定义封装函数-->
<script src="../static/public/js/jquery.md5.js"></script><!--自定义封装函数-->
<script src="../static/public/layer/layer.js"></script>
<script src="../static/public/js/jquery.nicescroll.js"></script>
<script src="../static/public/js/dateformat.js"></script>
<script src="../static/public/js/template.js"></script>
<script src="../static/public/js/swfobject.js"></script>
<script src="../static/public/js/jquery.limarquee.js"></script>
<script src="../static/public/js/placeholders.jquery.min.js"></script>

<script src="../static/public/js/rollups/tripledes.js"></script>
<script src="../static/public/js/components/mode-ecb.js"></script>
<script src="../static/public/js/jquery.range-min.js"></script>
<script src="../static/public/js/move.js"></script>
<script src="../static/public/js/base.js"></script>
<script>




</script>
<script>
    //获取验证码
    function refreshYzm() {
        var tel = $('#retrieveAccount').val();
        var myreg = /^((1[0-9]{2})+\d{8})$/;
        if(!tel){
            layer.msg('请输入手机号');
            return false;
        };
        if(!myreg.test(tel)) {
            layer.msg('请输入有效的手机号码！');
            return false;
        };
        var phone = {
            mobile: tel,
            type: '2'
        };
        var mw = baseObj.mw(phone);
        ajaxRequest({
            url: CONFIG.BASEURL+'sms_send',
            data: {
                mw:mw
            },
            success: function (json) {
                var data = json.data;
                var code=json.code;
                var msg=json.msg;
                if(code=='200'){
                    layer.msg('发送成功');
                    getCountDownclick();
                }else{
                    layer.msg(msg);
                }
            }
        })
    };
    //重新获取验证码倒计时
    function getCountDownclick() {
        var timeData = 60;
        $("#retrieveGetYzm").attr('disabled','disabled');
        $("#retrieveGetYzm").css('background','rgb(255, 177, 114)');
        var time = setInterval(function () {
            $("#retrieveGetYzm").val(timeData+'秒后重新获取');
            timeData --;
            if(timeData == 0){
                $("#retrieveGetYzm").val('获取验证码');
                $("#retrieveGetYzm").removeAttr('disabled');
                $("#retrieveGetYzm").css('background','rgb(239, 107, 0)');
                clearTimeout(time);
            }
        },1000);
    };

    function showLoading() {
        layer.load(2, {
            shade: [0.1,'#000'] //0.1透明度的白色背景
        })
    }
    function hideLoading() {
        layer.closeAll();
    }
</script>
<script>
    function retrievePwd(){
        var account = $("#retrieveAccount").val().trim();
        var password = $("#retrievePassword").val().trim();
        var yzm = $("#retrieveYzm").val().trim();

        if (!account) {
            Tools.toast("请输入手机号");
            return;
        }
        if (!password) {
            Tools.toast("请输入密码");
            return;
        }
        var myreg = /^((1[0-9]{2})+\d{8})$/;
        if(!myreg.test(account)) {
            Tools.toast('请输入有效的手机号码！');
            return;
        }
        if (!yzm) {
            Tools.toast("请输入验证码");
            return;
        }
        var map = {};
        map['loginName'] = account;
        map['password'] = $.md5(password).toUpperCase();
        map['inpcode'] = yzm;
        console.log(map);
        var mw=baseObj.mw(map);
        $.ajax({
            type: "POST",
            url:CONFIG.BASEURL+'user_retrievePwd',
            dataType:'json',
            data:{
                mw:mw
            },
            success: function(ret){
                var code=ret.code;
                console.log("code::"+code);
                var msg=ret.msg;
                if(code=='200'){
                    var json = json.data.obj;
                    $.cookie("u", json.u, {path: "/"});
                    $.cookie("loginName", json.loginName, {path: "/"});
                    $.cookie("uid", json.u, {path: "/"});
                    window.location.href = "../index.html";
                }else{
                    layer.msg('修改失败');
//                location.reload();
                }
            },
            error: function (data) {
                console.log(data);
            }
        });
    };
</script>

</body>
</html>
